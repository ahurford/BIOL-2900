<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Lab 5 - Sexual Selection | BIOL 2900 - Principles of Evolution and Systematics</title>
  <meta name="description" content="Chapter 4 Lab 5 - Sexual Selection | BIOL 2900 - Principles of Evolution and Systematics" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Lab 5 - Sexual Selection | BIOL 2900 - Principles of Evolution and Systematics" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jlb686/BIOL2900" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Lab 5 - Sexual Selection | BIOL 2900 - Principles of Evolution and Systematics" />
  
  
  

<meta name="author" content="Youlian Tzenov, Johanna Bosch, Amy Hurford" />


<meta name="date" content="2023-03-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab-4---natural-selection.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOL-2900</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting Started with R</a></li>
<li class="chapter" data-level="2" data-path="lab-2---making-an-rmarkdown-file.html"><a href="lab-2---making-an-rmarkdown-file.html"><i class="fa fa-check"></i><b>2</b> Lab 2 - Making an RMarkdown File</a></li>
<li class="chapter" data-level="3" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html"><i class="fa fa-check"></i><b>3</b> Lab 4 - Natural Selection</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#plotting-parent-population-beak-depth"><i class="fa fa-check"></i><b>3.2</b> Plotting Parent Population Beak Depth</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-1"><i class="fa fa-check"></i><b>3.2.1</b> STEP 1</a></li>
<li class="chapter" data-level="3.2.2" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-2"><i class="fa fa-check"></i><b>3.2.2</b> STEP 2</a></li>
<li class="chapter" data-level="3.2.3" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-3"><i class="fa fa-check"></i><b>3.2.3</b> STEP 3</a></li>
<li class="chapter" data-level="3.2.4" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-4"><i class="fa fa-check"></i><b>3.2.4</b> STEP 4</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#plotting-the-entire-populations-beak-depth"><i class="fa fa-check"></i><b>3.3</b> Plotting the Entire Population’s Beak Depth</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-5"><i class="fa fa-check"></i><b>3.3.1</b> STEP 5</a></li>
<li class="chapter" data-level="3.3.2" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-6"><i class="fa fa-check"></i><b>3.3.2</b> STEP 6</a></li>
<li class="chapter" data-level="3.3.3" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-7"><i class="fa fa-check"></i><b>3.3.3</b> STEP 7</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#plotting-the-survivor-populations-beak-depth"><i class="fa fa-check"></i><b>3.4</b> Plotting the Survivor Population’s Beak Depth</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-8"><i class="fa fa-check"></i><b>3.4.1</b> STEP 8</a></li>
<li class="chapter" data-level="3.4.2" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-9"><i class="fa fa-check"></i><b>3.4.2</b> STEP 9</a></li>
<li class="chapter" data-level="3.4.3" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-10"><i class="fa fa-check"></i><b>3.4.3</b> STEP 10</a></li>
<li class="chapter" data-level="3.4.4" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-11"><i class="fa fa-check"></i><b>3.4.4</b> STEP 11</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#statistical-analysis"><i class="fa fa-check"></i><b>3.5</b> Statistical Analysis</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-12"><i class="fa fa-check"></i><b>3.5.1</b> STEP 12</a></li>
<li class="chapter" data-level="3.5.2" data-path="lab-4---natural-selection.html"><a href="lab-4---natural-selection.html#step-13"><i class="fa fa-check"></i><b>3.5.2</b> STEP 13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html"><i class="fa fa-check"></i><b>4</b> Lab 5 - Sexual Selection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#getting-started"><i class="fa fa-check"></i><b>4.2</b> Getting Started</a></li>
<li class="chapter" data-level="4.3" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#plotting-figure-1---eyespots-increases-mates"><i class="fa fa-check"></i><b>4.3</b> Plotting Figure 1 - Eyespots increases mates</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#step-1-1"><i class="fa fa-check"></i><b>4.3.1</b> STEP 1:</a></li>
<li class="chapter" data-level="4.3.2" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#step-2-1"><i class="fa fa-check"></i><b>4.3.2</b> STEP 2:</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#plotting-figure-2---eyespots-increases-copulations"><i class="fa fa-check"></i><b>4.4</b> Plotting Figure 2 - Eyespots Increases Copulations</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#step-3-1"><i class="fa fa-check"></i><b>4.4.1</b> STEP 3:</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#plotting-figure-3---eyespots-increases-copulations"><i class="fa fa-check"></i><b>4.5</b> Plotting Figure 3 - Eyespots Increases Copulations</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#step-4-1"><i class="fa fa-check"></i><b>4.5.1</b> STEP 4:</a></li>
<li class="chapter" data-level="4.5.2" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#step-5-1"><i class="fa fa-check"></i><b>4.5.2</b> STEP 5:</a></li>
<li class="chapter" data-level="4.5.3" data-path="lab-5---sexual-selection.html"><a href="lab-5---sexual-selection.html#step-6-1"><i class="fa fa-check"></i><b>4.5.3</b> STEP 6:</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOL 2900 - Principles of Evolution and Systematics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab-5---sexual-selection" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Lab 5 - Sexual Selection<a href="lab-5---sexual-selection.html#lab-5---sexual-selection" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="introduction-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction<a href="lab-5---sexual-selection.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Description of lab</strong></p>
<p>During this week’s lab, students will analyze and interpret a variety of peacock train empirical data for evidence of sexual selection and trade-offs.</p>
<p>Students will gain knowledge/experience writing mathematical hypotheses, analyzing empirical sample data using RStudio (specifically ggplot2,a popular R package for data visualization) and interpreting it to identify the supported hypotheses. Students will also consider a range of supplemental data to assess the validity of the sexual selection theory.</p>
<pre><code>In this R tutorial, you will generate 2 scatterplots and a bargraph:

  1 - Relationship between peahen mates and the number of eyespots in the peacock&#39;s train.
  2 - The relationship number of copulations a peacock obtains and the number of eyespots in the peacock&#39;s train
  3 - Change in number of copulations for those peacocks that had eyespots removed
  
You will also run some statistical analyses on your data.</code></pre>
<hr />
</div>
<div id="getting-started" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Getting Started<a href="lab-5---sexual-selection.html#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, install the packages you need to use ggplot <strong>ggplot</strong> is a graphing software</p>
<pre><code>  install.packages(&quot;tidyverse&quot;)
  install.packages(&quot;ggplot2&quot;)</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="lab-5---sexual-selection.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Then, load each package</span></span>
<span id="cb26-2"><a href="lab-5---sexual-selection.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="lab-5---sexual-selection.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb26-4"><a href="lab-5---sexual-selection.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Next, open R Studio and set your working directory</p>
<p><strong>HINT</strong>: use the <strong>setwd(” “)</strong> command (as in Lab 2)</p>
<p>Download the <code>l5_dataset.csv</code> file from brightspace and save it to your working directory folder.</p>
<p>Read the <code>l5_dataset.csv</code> into R Studio using the ‘read.csv’ command (as in Lab 2)</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="lab-5---sexual-selection.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure to give it the vector name &#39;l5_dataset&#39;</span></span>
<span id="cb27-2"><a href="lab-5---sexual-selection.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="lab-5---sexual-selection.html#cb27-3" aria-hidden="true" tabindex="-1"></a>l5_dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;l5_dataset.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Now load your metadata file that contains important information about your dataset <strong>NOTE</strong>: the information on the variables can be found in the <code>l5_metadata.csv</code> file (on brightspace).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="lab-5---sexual-selection.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load the metadata file and name the vector l5_metadata</span></span>
<span id="cb28-2"><a href="lab-5---sexual-selection.html#cb28-2" aria-hidden="true" tabindex="-1"></a>l5_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;l5_metadata.csv&quot;</span>)</span>
<span id="cb28-3"><a href="lab-5---sexual-selection.html#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="lab-5---sexual-selection.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#now open both the metadata file and the l5_dataset, use:</span></span>
<span id="cb28-5"><a href="lab-5---sexual-selection.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(l5_metadata)</span>
<span id="cb28-6"><a href="lab-5---sexual-selection.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(l5_dataset)</span></code></pre></div>
<p>Each column in the l5_dataset is described in your metadata file
<strong>NOTE</strong>: you can come back to this metadata file at any point to find your references, and if you need to check what each column of the l5_dataset means
The view() command will only work if you loaded the ‘tidyverse’ package above</p>
<p><strong>Which column represents the mean change seasonal copulations of peacocks with 20 eyespots removed from trains?</strong>
<strong>Which variables are your control? which are your experimental?</strong></p>
</div>
<div id="plotting-figure-1---eyespots-increases-mates" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Plotting Figure 1 - Eyespots increases mates<a href="lab-5---sexual-selection.html#plotting-figure-1---eyespots-increases-mates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<div id="step-1-1" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> STEP 1:<a href="lab-5---sexual-selection.html#step-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Import columns as vectors, this is ALREADY done for you.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="lab-5---sexual-selection.html#cb29-1" aria-hidden="true" tabindex="-1"></a>f1_eyespots <span class="ot">&lt;-</span> l5_dataset<span class="sc">$</span>f1_n_eyespots</span>
<span id="cb29-2"><a href="lab-5---sexual-selection.html#cb29-2" aria-hidden="true" tabindex="-1"></a>f1_mates <span class="ot">&lt;-</span> l5_dataset<span class="sc">$</span>f1_n_mates</span>
<span id="cb29-3"><a href="lab-5---sexual-selection.html#cb29-3" aria-hidden="true" tabindex="-1"></a>f2_eyespots <span class="ot">&lt;-</span> l5_dataset<span class="sc">$</span>f2_n_eyespots</span>
<span id="cb29-4"><a href="lab-5---sexual-selection.html#cb29-4" aria-hidden="true" tabindex="-1"></a>f2_cop <span class="ot">&lt;-</span> l5_dataset<span class="sc">$</span>f2_n_cop</span>
<span id="cb29-5"><a href="lab-5---sexual-selection.html#cb29-5" aria-hidden="true" tabindex="-1"></a>f3_cont <span class="ot">&lt;-</span> l5_dataset<span class="sc">$</span>f3_cont</span>
<span id="cb29-6"><a href="lab-5---sexual-selection.html#cb29-6" aria-hidden="true" tabindex="-1"></a>f3_exp <span class="ot">&lt;-</span> l5_dataset<span class="sc">$</span>f3_exp</span></code></pre></div>
<hr />
</div>
<div id="step-2-1" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> STEP 2:<a href="lab-5---sexual-selection.html#step-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the last lab you used the base plot functions to plot graphs, but ggplot2 creates graphs using a step-by-step process that combines independent layers. The ggplot2 package is more flexible and powerful than the base plot functions.</p>
<p>Generate a scatterplot using ggplot2, this step is outlined and you should refer to it when you are making the scatterplots for the next steps.</p>
<p><strong>HINT</strong>: these steps are outlined in the Quantitative Guide (<a href="https://ahurford.github.io/quant-guide-all-courses/ggplot.html#making-scatter-plots-with-ggplot2" class="uri">https://ahurford.github.io/quant-guide-all-courses/ggplot.html#making-scatter-plots-with-ggplot2</a>)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="lab-5---sexual-selection.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Let&#39;s begin build our graphic one step at a time</span></span>
<span id="cb30-2"><a href="lab-5---sexual-selection.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#first let&#39;s use the ggplot() function to specify our data frame and set our x and y variables within the aesthetic aes().</span></span>
<span id="cb30-3"><a href="lab-5---sexual-selection.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#When we run this code, it produces a blank figure with our x and y axis set because we haven’t specified the type of graphic we want.</span></span>
<span id="cb30-4"><a href="lab-5---sexual-selection.html#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="lab-5---sexual-selection.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> l5_dataset, <span class="fu">aes</span>(<span class="at">x =</span> f1_eyespots, <span class="at">y =</span> f1_mates))</span></code></pre></div>
<p>Now that we have our plot layer, let’s add the points to our scatterplot using another layer called geom_point</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="lab-5---sexual-selection.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to add a layer in ggplot() we can use the &#39;+&#39; symbol at the end of each line, like this:</span></span>
<span id="cb31-2"><a href="lab-5---sexual-selection.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="lab-5---sexual-selection.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> l5_dataset, <span class="fu">aes</span>(<span class="at">x =</span> f1_eyespots, <span class="at">y =</span> f1_mates)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="lab-5---sexual-selection.html#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>Let’s make the graph a little easier to read:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="lab-5---sexual-selection.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add size and colour to your points using the &#39;size=&#39;, &#39;shape=&#39; and &#39;colour=&#39; aesthetics</span></span>
<span id="cb32-2"><a href="lab-5---sexual-selection.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#we&#39;ve added the &#39;na.rm=TRUE&#39; argument to remove any NA values in the l5_dataset</span></span>
<span id="cb32-3"><a href="lab-5---sexual-selection.html#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="lab-5---sexual-selection.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> l5_dataset, <span class="fu">aes</span>(<span class="at">x =</span> f1_eyespots, <span class="at">y =</span> f1_mates)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="lab-5---sexual-selection.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">17</span>, <span class="at">colour=</span><span class="st">&quot;salmon&quot;</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>You can find a list of R colors here, pick one you like and replace it with the ‘salmon’ colour: <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf" class="uri">http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf</a>
You can find a list of shapes to pick from here, they are represented numerically (for example, ‘17’ represents a solid triangle). Pick one you like: <a href="http://www.sthda.com/english/wiki/ggplot2-point-shapes" class="uri">http://www.sthda.com/english/wiki/ggplot2-point-shapes</a></p>
<p>Now that we have our main point plotted, let’s <strong>add a regression line</strong> to the scatterplot, this is ALREADY done for you:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="lab-5---sexual-selection.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the argument &#39;method =“lm”&#39; fits a linear model through your data</span></span>
<span id="cb33-2"><a href="lab-5---sexual-selection.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#the argument &#39;se=TRUE&#39; adds a grey shaded confidence interval around the line of best fit</span></span>
<span id="cb33-3"><a href="lab-5---sexual-selection.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#the &#39;level=&#39; argument specifies the level of the confidence interval to use</span></span>
<span id="cb33-4"><a href="lab-5---sexual-selection.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="lab-5---sexual-selection.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> l5_dataset, <span class="fu">aes</span>(<span class="at">x =</span> f1_eyespots, <span class="at">y =</span> f1_mates)) <span class="sc">+</span></span>
<span id="cb33-6"><a href="lab-5---sexual-selection.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">17</span>, <span class="at">colour=</span><span class="st">&quot;salmon&quot;</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="lab-5---sexual-selection.html#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">TRUE</span>, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Ggplot2 also allows you to add axis labels to your plot, let’s add a tag to the graph called “A”, and axis labels using the ‘labs()’ function</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="lab-5---sexual-selection.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make sure you keep the &#39;na.rm=TRUE&#39; argument </span></span>
<span id="cb34-2"><a href="lab-5---sexual-selection.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="lab-5---sexual-selection.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> l5_dataset, <span class="fu">aes</span>(<span class="at">x =</span> f1_eyespots, <span class="at">y =</span> f1_mates)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="lab-5---sexual-selection.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">17</span>, <span class="at">colour=</span><span class="st">&quot;salmon&quot;</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="lab-5---sexual-selection.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">TRUE</span>, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="lab-5---sexual-selection.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag=</span><span class="st">&quot;A&quot;</span>, <span class="at">x=</span><span class="st">&quot;Number of eyespots&quot;</span>, <span class="at">y=</span><span class="st">&quot;Number of mates&quot;</span>)</span></code></pre></div>
<p>Here, we are naming the final plot ‘a’ so we can use patchwork to put all our plots together</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="lab-5---sexual-selection.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to make our graph look nicer, we can also add themes</span></span>
<span id="cb35-2"><a href="lab-5---sexual-selection.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#choose to add either the &#39;theme_dark()&#39; or &#39;theme_light&#39; for this graph</span></span>
<span id="cb35-3"><a href="lab-5---sexual-selection.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use the &#39;base_size=&#39; argument to change the size of the labels on your graph</span></span>
<span id="cb35-4"><a href="lab-5---sexual-selection.html#cb35-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> l5_dataset, <span class="fu">aes</span>(<span class="at">x =</span> f1_eyespots, <span class="at">y =</span> f1_mates)) <span class="sc">+</span></span>
<span id="cb35-5"><a href="lab-5---sexual-selection.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">17</span>, <span class="at">colour=</span><span class="st">&quot;salmon&quot;</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="lab-5---sexual-selection.html#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">TRUE</span>, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a href="lab-5---sexual-selection.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag=</span><span class="st">&quot;A&quot;</span>, <span class="at">x=</span><span class="st">&quot;Number of eyespots&quot;</span>, <span class="at">y=</span><span class="st">&quot;Number of mates&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-8"><a href="lab-5---sexual-selection.html#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size=</span><span class="dv">12</span>)</span>
<span id="cb35-9"><a href="lab-5---sexual-selection.html#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="lab-5---sexual-selection.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">#view your figure by running &#39;a&#39;:</span></span>
<span id="cb35-11"><a href="lab-5---sexual-selection.html#cb35-11" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<p><img src="BIOL-2900_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>This is what your final figure should look like, with your own custom colour and shape!</p>
<hr />
</div>
</div>
<div id="plotting-figure-2---eyespots-increases-copulations" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Plotting Figure 2 - Eyespots Increases Copulations<a href="lab-5---sexual-selection.html#plotting-figure-2---eyespots-increases-copulations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>NOTE</strong>: some of this code is only PARTIALLY written for you, refer to the steps above</p>
<hr />
<div id="step-3-1" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> STEP 3:<a href="lab-5---sexual-selection.html#step-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We already imported the columns as vectors in Step 1, you do not need to do this again. Let’s generate a scatterplot called ‘b’, this time replace the ‘???’ with the correct arguments (refer to step 2 for help)</p>
<p><strong>NOTE</strong>: don’t forget to choose either the ‘theme_light’ or ‘theme_dark’ function</p>
<pre><code> b &lt;- ggplot(data = l5_dataset, aes(x =???, y =???)) +
    geom_point(size=3, shape=17, colour=&quot;???&quot;, na.rm=TRUE) +
    geom_smooth(method=lm, se=TRUE, level=0.95, na.rm=TRUE) +
    labs(tag=&quot;B&quot;, x=&quot;???&quot;, y=&quot;???&quot;) +
    theme_???(base_size=12)</code></pre>
<p><strong>HINT</strong>: If you do not know what to label your x and y axis, refer to your metadata file</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="lab-5---sexual-selection.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(l5_metadata)</span></code></pre></div>
<p>Remember to use the Export button above your figure to save as an image</p>
<hr />
</div>
</div>
<div id="plotting-figure-3---eyespots-increases-copulations" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Plotting Figure 3 - Eyespots Increases Copulations<a href="lab-5---sexual-selection.html#plotting-figure-3---eyespots-increases-copulations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<div id="step-4-1" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> STEP 4:<a href="lab-5---sexual-selection.html#step-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, let’s plot Figure 3 using ggplot2, we will call this figure ‘c’</p>
<p>First, let’s find the mean values for each treatment and create a data frame</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="lab-5---sexual-selection.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define your mean for both the control and experimental variables </span></span>
<span id="cb38-2"><a href="lab-5---sexual-selection.html#cb38-2" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">mean</span>(f3_cont, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb38-3"><a href="lab-5---sexual-selection.html#cb38-3" aria-hidden="true" tabindex="-1"></a>experimental <span class="ot">&lt;-</span> <span class="fu">mean</span>(f3_exp, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb38-4"><a href="lab-5---sexual-selection.html#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="lab-5---sexual-selection.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#now create a value for your means</span></span>
<span id="cb38-6"><a href="lab-5---sexual-selection.html#cb38-6" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="fu">c</span>(experimental, control)</span>
<span id="cb38-7"><a href="lab-5---sexual-selection.html#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="lab-5---sexual-selection.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#then create a dataframe that has your mean values for both control and experimental</span></span>
<span id="cb38-9"><a href="lab-5---sexual-selection.html#cb38-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Control&quot;</span>), mean)</span></code></pre></div>
<p>Now that you have your data frame set up, let’s plot the mean and standard deviation (sd) for the treatment groups
Like before, we will use ggplot() and specify we want to use the ‘df’ dataframe</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="lab-5---sexual-selection.html#cb39-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;mean&#39; will be the x variable, and &#39;group&#39; will be the y variable</span></span>
<span id="cb39-2"><a href="lab-5---sexual-selection.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use the &#39;geom_errorbarh()&#39; function to add horizontal error bars to the plot using sd of the means</span></span>
<span id="cb39-3"><a href="lab-5---sexual-selection.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="lab-5---sexual-selection.html#cb39-4" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x =</span> mean, <span class="at">y =</span> group)) <span class="sc">+</span></span>
<span id="cb39-5"><a href="lab-5---sexual-selection.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="lab-5---sexual-selection.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> mean <span class="sc">-</span> <span class="fu">sd</span>(df<span class="sc">$</span>mean), <span class="at">xmax =</span> mean <span class="sc">+</span> <span class="fu">sd</span>(df<span class="sc">$</span>mean)), <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="lab-5---sexual-selection.html#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag=</span><span class="st">&quot;C&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Mean&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="lab-5---sexual-selection.html#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb39-9"><a href="lab-5---sexual-selection.html#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="lab-5---sexual-selection.html#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#in this case, group is a categorical variable with two levels: &quot;Experimental&quot; and &quot;Control&quot;.</span></span>
<span id="cb39-11"><a href="lab-5---sexual-selection.html#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#it means that the points for the &quot;Experimental&quot; group will be grouped together on the top of the plot, and the points for the &quot;Control&quot; group will be grouped together on the bottom of the plot.</span></span>
<span id="cb39-12"><a href="lab-5---sexual-selection.html#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#this makes it easy to see the difference between the means of the two groups.</span></span></code></pre></div>
<hr />
</div>
<div id="step-5-1" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> STEP 5:<a href="lab-5---sexual-selection.html#step-5-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s plot the 3 figures you made together using a package called patchwork First, install patchwork and load the library</p>
<pre><code>  install.packages(&quot;patchwork&quot;)
  library(patchwork)
  </code></pre>
<p>Next, simply patch your plots ‘a’, ‘b’, and ‘c’ together using the ‘+’ symbol:</p>
<pre><code>  a + b + c</code></pre>
<p><strong>NOTE</strong>: Now that you have all your plots together, shift the size of the plotting window in the bottom right to change the layout of the plot so that you can see everything better. Then, save your plot as an image using the Export button.</p>
<hr />
</div>
<div id="step-6-1" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> STEP 6:<a href="lab-5---sexual-selection.html#step-6-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Perform t.tests for control vs experimental data to determine if the means are significantly different between populations.</p>
<p><strong>NOTE</strong>: Refer to the metadata file to determine which datasets to compare.</p>
<pre><code> t.test(???, ???)</code></pre>
<p>To determine statistical significance, use the p-values you obtained from the t-tests. <strong>HINT:</strong> If the p-value is below 0.05, the datasets compared are significantly different.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab-4---natural-selection.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jlb686/BIOL-2900/edit/master/03-Lab5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jlb686/BIOL-2900/blob/master/03-Lab5.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
